(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/projectDevie/index"],{1220:function(e,t,a){"use strict";var i=a("c8b2"),n=a.n(i);n.a},"175b":function(e,t,a){"use strict";var i;a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=(e._self._c,e.__map(e.statudList,(function(t,a){var i=e.__get_orig(t),n="table"===t.showType?e.numFilter(t.acc):null,o="table"!==t.showType||t.vel<0?null:e.numFilter(t.vel),s="table"!==t.showType||t.dis<=0?null:e.numFilter(t.dis),r="table"!==t.showType||t.env<0?null:e.numFilter(t.env),c="pie"===t.showType&&""!=t.speed?e.numFilter(t.speed):null,d="pie"===t.showType&&""==t.speed?e.numFilter(t.acc):null;return{$orig:i,m0:n,m1:o,m2:s,m3:r,m4:c,m5:d}})));e.$mp.data=Object.assign({},{$root:{l0:a}})},o=[]},"23fc":function(e,t,a){"use strict";a.r(t);var i=a("448c"),n=a.n(i);for(var o in i)"default"!==o&&function(e){a.d(t,e,(function(){return i[e]}))}(o);t["default"]=n.a},"448c":function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;a("11c1");var i=s(a("7379")),n=a("70eb"),o=s(a("198b"));a("aa15");function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a("198b");var c,d={data:function(){return{standards:"",resulted:[],client:"",pointsed:"",timer:null,datamqtt:"",topic:"",cacheListedlist:"",cacheListed:{},alstate:"danger",chartData:{},itemcode:"",code:"",name:"",statudList:[],oilList:[],speedList:[],copyCode:null}},onLoad:function(e){var t=e.name,a=e.code,i=e.itemcode;this.name=t,this.code=a,this.itemcode=i,this.getStusedList(this.code),this.getDevicelistData(this.code),this.getServerData(this.code),this.connect(this.code)},onShow:function(){""==this.statudListed&&e.showLoading({title:"加载中"})},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){this.getStusedList(this.code),this.getDevicelistData(this.code),this.getServerData(this.code)},onReady:function(){this.getServerData()},methods:{numFilter:function(e){var t=parseFloat(e).toFixed(3);return t},getStusedList:function(e){var t=this;(0,n.statusedList)(e).then((function(e){console.log(e,"数据11"),t.statudList=e.data,t.statudList.map((function(e){switch(e.subtype){case 0:case 6:case 7:e.showType="table";break;case 5:e.showType="oil";break;case 0:e.showType="pie";break;case 1:e.showType="pie";break;default:e.showType="pie";break}}))}))},getDevicelistData:function(e){var t=this;(0,n.DevicelistData)(e).then((function(e){var a=e.data.points,i=e.data.oil;console.log(i,"油液"),console.log(a,"初始数据"),t.statudListed=t.statudList.map((function(i,n){a.map((function(a){if(i.code===a.point&&(i.acc_state=a.acc_state,i.vel_state=a.vel_state,i.dis_state=a.dis_state,i.env_state=a.env_state,i.temp_state=a.temp_state,i.state=a.state,t.$forceUpdate()),i.code===a.point)return i.acc=a.acc,i.vel=a.vel,i.dis=a.dis,i.env=a.env,i.temp=a.temp,i.time=a.time,i.speed=a.speed,i.alarmCode=a.alarmCode,i.alarmCode=JSON.parse(JSON.stringify(a.alarmCode)),void t.$forceUpdate();t.cacheListed=a.alarmCode,t.pointsed=e.data.points})),8!=i.subtype&&0!=i.subtype&&1!=i.subtype||t.showGauge0("canvasGauge"+n,t.statudList[n],n)})),t.statudList.map((function(e,a){i.map((function(a){if(a.pointCode)return e.roadVal1=a.roadVal1,e.roadVal2=a.roadVal2,e.roadVal3=a.roadVal3,e.roadVal4=a.roadVal4,e.roadVal5=a.roadVal5,e.roadVal6=a.roadVal6,e.alarmState1=a.alarmState1,e.alarmState2=a.alarmState2,e.alarmState3=a.alarmState3,e.alarmState4=a.alarmState4,e.alarmState5=a.alarmState5,e.alarmState6=a.alarmState6,e.dtime=a.dtime,e.humidity=a.humidity,void t.$forceUpdate();t.standards=a.standard}))}))}))},connect:function(e){var t=this;console.log(e,8);c=o.default.connect("wx://121.5.161.39:8083/mqtt",+{username:"admin",password:"public"}),c.on("connect",(function(){var t="vibview/data/+/"+e;c.subscribe(t,(function(e){e||(console.log(c,"订阅成功"),console.log(c+t,"订阅成功"))}))})),c.on("message",(function(a,i){var n=JSON.parse(i);t.resulted=n,t.resulted&&t.getDevicelistData(e)}))},showGauge0:function(t,a,n){var o=this,s=e.createCanvasContext(t,this);a.categories=[{value:.2,color:"#1890ff"},{value:.8,color:"#2fc25b"},{value:1,color:"#f04864"}];var c=a.acc/1e4;a.series=[{name:"",data:c}];new i.default(r({$this:o,canvasId:t,context:s,type:"gauge",color:[],padding:void 0,title:{name:"r/min",fontSize:14,color:"#14e4f0",offsetY:70},subtitle:{name:"转速",fontSize:14,color:"#10D0E1",offsetY:33},extra:{gauge:{fontSize:4,width:12,labelColor:"#999999",startAngle:.75,endAngle:.25,startNumber:0,endNumber:1e4,labelFormat:"",splitLine:{fontSize:4,radius:"10%",fixRadius:0,splitNumber:2,width:13,color:"#FFFFFF",childNumber:2,childWidth:4},pointer:{length:"20%",width:12,radius:10,color:"#1890ff"}}},width:e.upx2px(500),height:e.upx2px(290),categories:a.categories,series:a.series,animation:!0,dataLabel:!0},"animation",!1))},getServerData:function(){var e=this;setTimeout((function(){var t={categories:[{value:.2,color:"#1890ff"},{value:.8,color:"#2fc25b"},{value:1,color:"#f04864"}],series:[{name:"",data:.66}]};e.chartData=JSON.parse(JSON.stringify(t))}),500)},gotrendChart:function(t){t.id;var a=this.itemcode,i=this.code,n=t.code,o=t.name;if(7==t.subtype){var s={itemcode:a,eqtcode:i,pointcode:n,pointname:o};e.navigateTo({url:"/pages/trenddt/index?data=".concat(JSON.stringify(s))})}if(6==t.subtype){var r={itemcode:a,eqtcode:i,pointcode:n,pointname:o};e.navigateTo({url:"/pages/transtreds/index?data=".concat(JSON.stringify(r))})}if(5==t.subtype){var c={itemcode:a,eqtcode:i,pointcode:n,pointname:o};e.navigateTo({url:"/pages/trendoil/index?data=".concat(JSON.stringify(c))})}if(0==t.subtype){var d={itemcode:a,eqtcode:i,pointcode:n,pointname:o};e.navigateTo({url:"/pages/trendmy/index?data=".concat(JSON.stringify(d))})}if(1==t.subtype||2==t.subtype||3==t.subtype||4==t.subtype||8==t.subtype||9==t.subtype||11==t.subtype||10==t.subtype){var u={itemcode:a,eqtcode:i,pointcode:n,pointname:o};e.navigateTo({url:"/pages/trendprocess/index?data=".concat(JSON.stringify(u))})}},back:function(){e.navigateBack({delta:1})}}};t.default=d}).call(this,a("543d")["default"])},b654:function(e,t,a){"use strict";(function(e){a("aa96"),a("5c17");i(a("66fd"));var t=i(a("e9d2"));function i(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=a,e(t.default)}).call(this,a("543d")["createPage"])},c8b2:function(e,t,a){},e9d2:function(e,t,a){"use strict";a.r(t);var i=a("175b"),n=a("23fc");for(var o in n)"default"!==o&&function(e){a.d(t,e,(function(){return n[e]}))}(o);a("1220");var s,r=a("f0c5"),c=Object(r["a"])(n["default"],i["b"],i["c"],!1,null,"2e2cc47f",null,!1,i["a"],s);t["default"]=c.exports}},[["b654","common/runtime","common/vendor"]]]);